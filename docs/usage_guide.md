# USBブートLinux GUIディスクユーティリティ 使用ガイド

## 1. はじめに

このガイドでは、「USBブートLinux GUIディスクユーティリティ」の基本的な使い方を説明します。このプログラムは、Linux環境でディスクの操作（マウント、フォーマット、権限設定など）を簡単に行うためのツールです。

## 2. プログラムの起動方法

### 2.1 バイナリ（実行ファイル）から起動する場合

1. ダウンロードしたバイナリに実行権限を付与します。
   ```
   chmod +x salvage_linux
   ```

2. 管理者権限（sudo）で実行します。
   ```
   sudo ./salvage_linux
   ```

### 2.2 ソースコードから起動する場合

1. ソースコードがあるディレクトリに移動します。
   ```
   cd salvage_linux
   ```

2. 管理者権限（sudo）でプログラムを実行します。
   ```
   sudo python3 -m src.main
   ```

## 3. メイン画面の説明

プログラムを起動すると、以下のような画面が表示されます。

```
+-----------------------------------------------+
|  USBブートLinux GUIディスクユーティリティ v0.1.2  |
+-----------------------------------------------+
| ファイル▼ ヘルプ▼                             |
+----------------------+------------------------+
| 未マウントディスク     | マウント済みディスク      |
|                      |                        |
| +------------------+ | +------------------+   |
| | /dev/sda1 (32GB) | | | /media/usb1 (16GB) | |
| | /dev/sdb1 (16GB) | | +------------------+   |
| +------------------+ |                        |
|                      |                        |
| ディスク情報:         | ディスク情報:           |
| パス: /dev/sdb1      | パス: /media/usb1      |
| サイズ: 16GB         | マウントポイント:        |
| タイプ: ntfs         | /media/usb1            |
|                      | タイプ: vfat           |
| [マウント] [フォーマット] | [開く] [権限付与]      |
+----------------------+------------------------+
| ステータス: 準備完了                           |
+-----------------------------------------------+
```

画面は主に以下の部分から構成されています：

1. **メニューバー**: 「ファイル」と「ヘルプ」のメニューがあります。
2. **未マウントディスク一覧**: まだマウントされていないディスクの一覧です。
3. **マウント済みディスク一覧**: 既にマウントされているディスクの一覧です。
4. **ディスク情報表示部**: 選択したディスクの詳細情報を表示します。
5. **操作ボタン**: ディスクに対する操作（マウント、フォーマットなど）を行うボタンです。
6. **ステータスバー**: 現在の状態や進行中の操作を表示します。

## 4. 基本的な操作方法

### 4.1 ディスクのマウント（接続）

1. 左側の「未マウントディスク」リストから、マウントしたいディスクをクリックして選択します。
2. ディスクの情報が表示されることを確認します。
3. 「マウント」ボタンをクリックします。
4. マウント処理が開始され、ステータスバーに「○○をマウント中...」と表示されます。
5. マウントが成功すると、成功メッセージが表示され、ディスクが右側の「マウント済みディスク」リストに移動します。

### 4.2 ディスクのフォーマット（初期化）

**注意**: フォーマットを行うと、そのディスク上のデータはすべて消去されます。必要なデータのバックアップを取ってから実行してください。

1. 左側の「未マウントディスク」リストから、フォーマットしたいディスクをクリックして選択します。
2. 「フォーマット」ボタンをクリックします。
3. フォーマット形式を選択するダイアログが表示されます（exFAT, FAT32, NTFS, ext4など）。
4. フォーマット形式を選択して「OK」をクリックします。
5. 確認ダイアログが表示されるので、「はい」をクリックします。
6. フォーマット処理が開始され、ステータスバーに「○○をフォーマット中...」と表示されます。
7. フォーマットが成功すると、成功メッセージが表示されます。

### 4.3 マウント済みディスクをファイルマネージャーで開く

1. 右側の「マウント済みディスク」リストから、表示したいディスクをクリックして選択します。
2. 「開く」ボタンをクリックします。
3. お使いのLinux環境のファイルマネージャーが起動し、選択したディスクの内容が表示されます。

### 4.4 ディスクに権限を付与する

1. 右側の「マウント済みディスク」リストから、権限を付与したいディスクをクリックして選択します。
2. 「権限付与」ボタンをクリックします。
3. 確認ダイアログが表示されるので、「はい」をクリックします。
4. 権限付与処理が開始され、ステータスバーに「○○に権限を付与中...」と表示されます。
5. 処理が成功すると、成功メッセージが表示されます。
6. これにより、そのディスクにすべてのユーザーが読み書きできるようになります。

## 5. 設定の変更

### 5.1 設定画面を開く

1. メニューバーの「ファイル」→「設定」をクリックするか、ツールバーの「設定」ボタンをクリックします。
2. 設定ダイアログが表示されます。

### 5.2 一般設定

「一般設定」タブでは、以下の設定を変更できます：

- **ログレベル**: プログラムがどの程度詳細なログを記録するかを設定します。
  - DEBUG: 最も詳細なログ（開発者向け）
  - INFO: 標準的な操作ログ（推奨）
  - WARNING: 警告以上のみ記録
  - ERROR: エラーのみ記録
  - CRITICAL: 重大エラーのみ記録

- **言語**: プログラムの表示言語を設定します（今後のバージョンで変更可能になる予定です）。

### 5.3 ファイルマネージャー設定

「ファイルマネージャー」タブでは、以下の設定を変更できます：

- **自動検出（推奨）**: 環境に応じて適切なファイルマネージャーを自動的に選択します。
- **特定のファイルマネージャーを指定**: 使用するファイルマネージャーを直接指定します。
- **ファイルマネージャーの優先順位**: 自動検出時に試す順番を設定します。

### 5.4 詳細設定

「詳細設定」タブでは、以下の設定を変更できます：

- **デフォルトフォーマット形式**: フォーマット時のデフォルト形式を設定します。
  - exFAT（推奨）: Windows、Mac、Linuxで読み書き可能な形式
  - FAT32: 広く互換性がありますが、4GB以上のファイルが保存できません
  - NTFS: Windowsとの互換性が高い形式
  - ext4: Linux向けの高性能なファイルシステム

### 5.5 設定の保存と適用

1. 設定を変更したら、「保存」ボタンをクリックします。
2. 設定が保存され、ダイアログが閉じます。
3. 新しい設定が即座に適用されます。

## 6. よくある問題と解決方法

### 6.1 権限エラー

**問題**: 「権限エラー」や「このアプリケーションはスーパーユーザー権限で実行する必要があります」というメッセージが表示される。

**解決方法**: プログラムを `sudo` コマンドを使って実行してください。
```
sudo ./salvage_linux
```

### 6.2 ディスクが表示されない

**問題**: 接続しているUSBドライブやディスクが一覧に表示されない。

**解決方法**:
1. ディスクが物理的に正しく接続されているか確認します。
2. 「ファイル」メニューの「更新」をクリックするか、プログラムを再起動します。
3. コマンドラインで `lsblk` コマンドを実行して、システムがディスクを認識しているか確認します。

### 6.3 マウントに失敗する

**問題**: ディスクのマウントに失敗し、エラーメッセージが表示される。

**解決方法**:
1. ディスクが壊れていないか確認します。
2. ディスクがWindows由来の場合、Windowsの「高速スタートアップ」が無効になっているか確認します。
3. 「設定」→「ログレベル」を「DEBUG」に設定して、より詳細なログを確認します。

### 6.4 フォーマットに失敗する

**問題**: ディスクのフォーマットに失敗する。

**解決方法**:
1. ディスクが書き込み保護されていないか確認します。
2. システムディスク（例: /dev/sda）ではなく、パーティション（例: /dev/sda1）を選択しているか確認します。
3. 別のフォーマット形式を試してみます。

## 7. 安全に使用するための注意点

1. **データのバックアップ**: フォーマットや権限変更を行う前に、重要なデータのバックアップを取っておきましょう。
2. **システムディスクの操作注意**: システムが使用しているディスク（OSがインストールされているディスク）の操作には注意しましょう。
3. **十分な知識**: ディスクの操作は取り返しのつかない結果を招くことがあります。操作の意味を理解した上で実行しましょう。
4. **Windowsとの共存**: Windows と Linux のデュアルブート環境では、Windows の「高速スタートアップ」機能を無効にすることをお勧めします。

## 8. まとめ

USBブートLinux GUIディスクユーティリティを使えば、コマンドラインを使わなくても、簡単にディスクの操作ができます。このガイドを参考に、安全にディスク操作を行ってください。

ご不明な点や問題がありましたら、GitHubのIssueページでお知らせください。 